<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video</title>
</head>
<style>
    *{
        background-color: hsl(210deg 40% 16%);
        color: hsl(210deg 10% 90%);
        font-family:  "Cartograph CF", monospace;

    }
    .main{
        display: flex;
        flex-direction: row;
    }
    
    .record{
        display: flex;
        flex-direction: column;
        margin-left: 5%;
        margin-right: 5%;
        border: 3px solid hsl(210deg 10% 90%);
        border-radius: 3px;
    }
    .recorded{
        display: flex;
        flex-direction: column;
        margin-left: 5%;
        margin-right: 5%;
        border: 3px solid hsl(210deg 10% 90%);
        border-radius: 3px;
    }
    button{
        background-color:hsl(210deg 10% 90%); 
        color: hsl(210deg 40% 16%);
        border: 3px solid hsl(210deg 10% 90%);
        margin-left: 50%;
        margin-right: 50%;
        
    }

    #video, #start, #send, .video{
        margin-top: 15px;
        
    }
    .question{
        margin-left: 5%;
        margin-right:  5%;

    }
    li{
       
        margin-top: 5px;
    }

    #video-container {
            position: relative;
            display: inline-block;
    }
    #overlay{
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 20px;
            font-size: 20px;
            border-radius: 10px;
            display: none;
    }
</style>
<body>
    <div class="main">
        <div class="question">
            <ol>
                <li>
                   <p> What is your name ?</p>
                </li>
                <li>
                   <p>
                    Tell us a little bit about your previous job ? 
                   </p>
                </li>
                <li>
                    <p>What was the biggest challenges you faced in your previous job ?</p>
                </li>
                <li>
                    <p>How did you solve challenges ?</p>
                </li>
                <li>
                    <p>What is Your Hobby ?</p>
                </li>
            </ol>
        </div>
        <div class="record">
            <div id="video-container">
                <video id="video" autoplay></video>
                <div id="overlay">Recording starts in 3...</div>
            </div-video-container>
            <button id="start">start</button>
        </div>
        <div class="recorded">
            <video id="recorded-video" class="video" controls></video>
            <button id="send">send</button>
        </div>
    </div>
    

<script>
    const videoContainer=document.getElementById("video-container")
    const overlay= document.getElementById("overlay")
    const video=document.getElementById("video")
    const start=document.getElementById("start")
    const send=document.getElementById("send")
    const record=document.getElementById("recorded-video")

    let mediaRecorder;
    let recordchunk=[]
    
    async function startVideoStream(){
        try{
                let stream=await navigator.mediaDevices.getUserMedia({video: true,audio: true})
                video.srcObject=stream
                mediaRecorder=new MediaRecorder(stream)
                mediaRecorder.ondataavailable =(event)=>{
                    
                    if(event.data.size > 0){
                        recordchunk.push(event.data)
                    }
                }
                mediaRecorder.onstop =()=>{
                    const blob = new Blob(recordchunk,{type:'video/webm'})
                    const videourl=URL.createObjectURL(blob)
                    video.src=videourl
            }
        }catch(err){
            console.error(err)
        }
        
    }
    start.addEventListener("click",()=>{
        try{

            recordChunks = []; // Clear previous recordings
            overlay.style.display = "block"; // Show countdown overlay
            overlay.innerText = "Recording starts in 3...";
            
            let countdown = 3;
            const countdownInterval = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                    overlay.innerText = `Recording starts in ${countdown}...`;
                } else {
                    clearInterval(countdownInterval);
                    overlay.style.display = "none"; // Hide overlay when recording starts
                    mediaRecorder.start();
                    setTimeout(()=>{
                        mediaRecorder.stop()
                        start.disabled=false
                    },1000)
                }
            }, 1000);            
            
        } catch(err){
            console.error(err);
            
        }

    })
    
    startVideoStream()

</script>
</body>
</html>